/*! nsyslog-parser 2017-06-16 */

"use strict";!function e(i,l,t){function a(s,n){if(!l[s]){if(!i[s]){var o="function"==typeof require&&require;if(!n&&o)return o(s,!0);if(r)return r(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var d=l[s]={exports:{}};i[s][0].call(d.exports,function(e){var l=i[s][1][e];return a(l||e)},d,d.exports,e,i,l,t)}return l[s].exports}for(var r="function"==typeof require&&require,s=0;s<t.length;s++)a(t[s]);return a}({1:[function(e,i,l){!function(i){var l=e("./parser.js");i.NSyslog=i.NSyslog||{},i.NSyslog.parse=l}(window)},{"./parser.js":2}],2:[function(e,i,l){function t(e,i){if(e.host)if(e.appName)if(e.pid)if(e.messageid){if(e.structuredData)return!0;e.structuredData=i.trim()}else e.messageid=i.trim();else e.pid=i.trim();else e.appName=i.trim();else e.host=i.trim()}function a(e){var i=e.match(s.pri),l={originalMessage:e};if(i){l.pri=i[0],l.prival=parseInt(l.pri.match(s.prival)[1]);var a=r.get(l.prival);l.facilityval=a.facility,l.levelval=a.level,l.facility=r.FACILITY[a.facility].id,l.level=r.LEVEL[a.level].id}else l.pri="",l.prival=NaN;for(var n=e.substring(l.pri.length).split(" "),o=!1;e.length&&!o;){if((m=n.peek()+" ").match(s.prinmr))l.version=parseInt(m),l.type="RFC5424",(m=n.peek()+" ").match(s.ts)&&(l.ts=new Date(Date.parse(m.match(s.ts)[0].trim())));else if(m.match(s.month)){l.type="BSD";var c=m.trim(),d=n.peek(),u=n.peek(),f=(new Date).getYear()+1900;l.ts=new Date(Date.parse(f+" "+c+" "+d+" "+u))}else l.type="UNKNOWN",n.unshift(m.trim());o=!0}if(l.ts||(l.ts=new Date),l.type){var p=function(e){n.unshift(e),l.message=n.join(" "),o=!0};for(o=!1;e.length&&!o;){var m=n.peek();if(m)if(m.endsWith(":")){var y=m.replace(/:$/,"").trim();y.match(s.invalid)?p(m):(t(l,y),l.message=n.join(" "),o=!0)}else n.length?m.match(s.invalid)?p(m):t(l,m.replace(/: $/,"").trim())&&(n.unshift(m),l.message=n.join(" "),o=!0):p(m);else o=!0}}else l.message=n.join(" ");if(l.chain=(l.host||"").split("/"),l.host=l.chain.pop(),"RFC5424"==l.type){var g=l.message.match(s.sdata)||[],b=0;l.structuredData=g.map(function(e){var i={},t=null;return b=l.message.indexOf(e)+e.length+1,e.replace(/(^\[)|(\]$)/g,"").split(" ").forEach(function(e,l){if(e.trim())if(0==l)i.$id=e;else{var a=e.split("=");a[0]&&a[1]&&'"'!=a[1]?(t=a.shift(),i[t]=a.join("=").replace(/\"/g,"")):a[0]&&void 0===a[1]?i[t]+=" "+(a[0]||"").replace(/\"/g,""):!a[0]||a[1].length&&'"'!=a[1]||(i[t]+=" "+(a[0]||"").replace(/\"/g,"")+"=")}}),i}),l.message=l.message.substring(b)}var h=[];return l.message.split(",").forEach(function(e){var i=e.split("=");2==i.length&&(h[i[0]]=i[1])}),l.fields=h,l.header=e.substring(0,e.length-l.message.length),l}var r=e("./pri.js"),s={pri:/^<\d+>/,prinmr:/^\d+ /,prival:/<(\d+)>/,month:/^[a-zA-Z]{3} /,day:/^\d{1,2} /,time:/^\d+:\d+:\d+ /,ts:/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\S+ /,invalid:/[^a-zA-Z0-9\.\$\-_#%\/]/,sdata:/\[(\S+)( [^\=]+\=\"[^\"]+\")+\]/g};Array.prototype.peek=function(){do{var e=this.shift();if(void 0===e)return e;e=e.trim()}while(!e);return e},i.exports=function(e){try{return a(e)}catch(e){return{err:e}}}},{"./pri.js":3}],3:[function(e,i,l){var t=[{id:"kern",label:"kernel messages"},{id:"user",label:"user-level messages"},{id:"mail",label:"mail system"},{id:"daemon",label:"system daemons"},{id:"auth",label:"security/authorization messages"},{id:"syslog",label:"messages generated internally by syslogd"},{id:"lpr",label:"line printer subsystem"},{id:"news",label:"network news subsystem"},{id:"uucp",label:"UUCP subsystem"},{id:"cron",label:"clock daemon"},{id:"authpriv",label:"security/authorization messages"},{id:"ftp",label:"FTP daemon"},{id:"ntp",label:"NTP subsystem"},{id:"security",label:"log audit"},{id:"console",label:"log alert"},{id:"solaris-cron",label:"clock daemon"},{id:"local0",label:"locally used facility 0"},{id:"local1",label:"locally used facility 0"},{id:"local2",label:"locally used facility 0"},{id:"local3",label:"locally used facility 0"},{id:"local4",label:"locally used facility 0"},{id:"local5",label:"locally used facility 0"},{id:"local6",label:"locally used facility 0"},{id:"local7",label:"locally used facility 0"}],a=[{id:"emerg",label:"system is unusable"},{id:"alert",label:"action must be taken immediately"},{id:"crit",label:"critical conditions"},{id:"error",label:"error conditions"},{id:"warn",label:"warning conditions"},{id:"notice",label:"normal but significant condition"},{id:"info",label:"informational messages"},{id:"debug",label:"debug-level messages"}],r=[],s=[];t.forEach(function(e,i){return r[e.id]=i}),a.forEach(function(e,i){return s[e.id]=i}),i.exports.LEVEL=a,i.exports.FACILITY=t,i.exports.LEVELS=s,i.exports.FACILITIES=r,i.exports.get=function(e,i){return"number"==typeof e&&void 0===i?{level:7&e,facility:e>>3}:"number"==typeof e&&"number"==typeof i?8*e+i:"string"==typeof e&&"number"==typeof i?8*(r[e]||0)+i:"number"==typeof e&&"string"==typeof i?8*e+(s[i]||0):"string"==typeof e&&"string"==typeof i?8*(r[e]||0)+(s[i]||0):{level:0,facility:0}}},{}]},{},[1]);